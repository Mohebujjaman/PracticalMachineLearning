---
title: "Predictionassignment"
author: "Mohebujjaman"
date: "August 14, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
> download.file(url = "https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv", destfile = "pml-training.csv")
trying URL 'https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv'
Content type 'text/csv' length 12202745 bytes (11.6 MB)
downloaded 11.6 MB

> download.file(url = "https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv", destfile = "pml-testing.csv")
trying URL 'https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv'
Content type 'text/csv' length 15113 bytes (14 KB)
downloaded 14 KB

> ptrain <- read.csv('pml-training.csv')
> ptest <- read.csv('pml-testing.csv')
> library(caret)
> library(ggplot2)
> library(lattice)
> library(kernlab)
> library(randomForest)
> str(ptrain)
'data.frame':	19622 obs. of  160 variables:
 $ X                       : int  1 2 3 4 5 6 7 8 9 10 ...
 $ user_name               : Factor w/ 6 levels "adelmo","carlitos",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ raw_timestamp_part_1    : int  1323084231 1323084231 1323084231 1323084232 1323084232 1323084232 1323084232 1323084232 1323084232 1323084232 ...
 $ raw_timestamp_part_2    : int  788290 808298 820366 120339 196328 304277 368296 440390 484323 484434 ...
 $ cvtd_timestamp          : Factor w/ 20 levels "02/12/2011 13:32",..: 9 9 9 9 9 9 9 9 9 9 ...
 $ new_window              : Factor w/ 2 levels "no","yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ num_window              : int  11 11 11 12 12 12 12 12 12 12 ...
 $ roll_belt               : num  1.41 1.41 1.42 1.48 1.48 1.45 1.42 1.42 1.43 1.45 ...
 $ pitch_belt              : num  8.07 8.07 8.07 8.05 8.07 8.06 8.09 8.13 8.16 8.17 ...
 $ yaw_belt                : num  -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 ...
 $ total_accel_belt        : int  3 3 3 3 3 3 3 3 3 3 ...
 $ kurtosis_roll_belt      : Factor w/ 397 levels "","-0.016850",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ kurtosis_picth_belt     : Factor w/ 317 levels "","-0.021887",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ kurtosis_yaw_belt       : Factor w/ 2 levels "","#DIV/0!": 1 1 1 1 1 1 1 1 1 1 ...
 $ skewness_roll_belt      : Factor w/ 395 levels "","-0.003095",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ skewness_roll_belt.1    : Factor w/ 338 levels "","-0.005928",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ skewness_yaw_belt       : Factor w/ 2 levels "","#DIV/0!": 1 1 1 1 1 1 1 1 1 1 ...
 $ max_roll_belt           : num  NA NA NA NA NA NA NA NA NA NA ...
 $ max_picth_belt          : int  NA NA NA NA NA NA NA NA NA NA ...
 $ max_yaw_belt            : Factor w/ 68 levels "","-0.1","-0.2",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ min_roll_belt           : num  NA NA NA NA NA NA NA NA NA NA ...
 $ min_pitch_belt          : int  NA NA NA NA NA NA NA NA NA NA ...
 $ min_yaw_belt            : Factor w/ 68 levels "","-0.1","-0.2",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ amplitude_roll_belt     : num  NA NA NA NA NA NA NA NA NA NA ...
 $ amplitude_pitch_belt    : int  NA NA NA NA NA NA NA NA NA NA ...
 $ amplitude_yaw_belt      : Factor w/ 4 levels "","#DIV/0!","0.00",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ var_total_accel_belt    : num  NA NA NA NA NA NA NA NA NA NA ...
 $ avg_roll_belt           : num  NA NA NA NA NA NA NA NA NA NA ...
 $ stddev_roll_belt        : num  NA NA NA NA NA NA NA NA NA NA ...
 $ var_roll_belt           : num  NA NA NA NA NA NA NA NA NA NA ...
 $ avg_pitch_belt          : num  NA NA NA NA NA NA NA NA NA NA ...
 $ stddev_pitch_belt       : num  NA NA NA NA NA NA NA NA NA NA ...
 $ var_pitch_belt          : num  NA NA NA NA NA NA NA NA NA NA ...
 $ avg_yaw_belt            : num  NA NA NA NA NA NA NA NA NA NA ...
 $ stddev_yaw_belt         : num  NA NA NA NA NA NA NA NA NA NA ...
 $ var_yaw_belt            : num  NA NA NA NA NA NA NA NA NA NA ...
 $ gyros_belt_x            : num  0 0.02 0 0.02 0.02 0.02 0.02 0.02 0.02 0.03 ...
 $ gyros_belt_y            : num  0 0 0 0 0.02 0 0 0 0 0 ...
 $ gyros_belt_z            : num  -0.02 -0.02 -0.02 -0.03 -0.02 -0.02 -0.02 -0.02 -0.02 0 ...
 $ accel_belt_x            : int  -21 -22 -20 -22 -21 -21 -22 -22 -20 -21 ...
 $ accel_belt_y            : int  4 4 5 3 2 4 3 4 2 4 ...
 $ accel_belt_z            : int  22 22 23 21 24 21 21 21 24 22 ...
 $ magnet_belt_x           : int  -3 -7 -2 -6 -6 0 -4 -2 1 -3 ...
 $ magnet_belt_y           : int  599 608 600 604 600 603 599 603 602 609 ...
 $ magnet_belt_z           : int  -313 -311 -305 -310 -302 -312 -311 -313 -312 -308 ...
 $ roll_arm                : num  -128 -128 -128 -128 -128 -128 -128 -128 -128 -128 ...
 $ pitch_arm               : num  22.5 22.5 22.5 22.1 22.1 22 21.9 21.8 21.7 21.6 ...
 $ yaw_arm                 : num  -161 -161 -161 -161 -161 -161 -161 -161 -161 -161 ...
 $ total_accel_arm         : int  34 34 34 34 34 34 34 34 34 34 ...
 $ var_accel_arm           : num  NA NA NA NA NA NA NA NA NA NA ...
 $ avg_roll_arm            : num  NA NA NA NA NA NA NA NA NA NA ...
 $ stddev_roll_arm         : num  NA NA NA NA NA NA NA NA NA NA ...
 $ var_roll_arm            : num  NA NA NA NA NA NA NA NA NA NA ...
 $ avg_pitch_arm           : num  NA NA NA NA NA NA NA NA NA NA ...
 $ stddev_pitch_arm        : num  NA NA NA NA NA NA NA NA NA NA ...
 $ var_pitch_arm           : num  NA NA NA NA NA NA NA NA NA NA ...
 $ avg_yaw_arm             : num  NA NA NA NA NA NA NA NA NA NA ...
 $ stddev_yaw_arm          : num  NA NA NA NA NA NA NA NA NA NA ...
 $ var_yaw_arm             : num  NA NA NA NA NA NA NA NA NA NA ...
 $ gyros_arm_x             : num  0 0.02 0.02 0.02 0 0.02 0 0.02 0.02 0.02 ...
 $ gyros_arm_y             : num  0 -0.02 -0.02 -0.03 -0.03 -0.03 -0.03 -0.02 -0.03 -0.03 ...
 $ gyros_arm_z             : num  -0.02 -0.02 -0.02 0.02 0 0 0 0 -0.02 -0.02 ...
 $ accel_arm_x             : int  -288 -290 -289 -289 -289 -289 -289 -289 -288 -288 ...
 $ accel_arm_y             : int  109 110 110 111 111 111 111 111 109 110 ...
 $ accel_arm_z             : int  -123 -125 -126 -123 -123 -122 -125 -124 -122 -124 ...
 $ magnet_arm_x            : int  -368 -369 -368 -372 -374 -369 -373 -372 -369 -376 ...
 $ magnet_arm_y            : int  337 337 344 344 337 342 336 338 341 334 ...
 $ magnet_arm_z            : int  516 513 513 512 506 513 509 510 518 516 ...
 $ kurtosis_roll_arm       : Factor w/ 330 levels "","-0.02438",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ kurtosis_picth_arm      : Factor w/ 328 levels "","-0.00484",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ kurtosis_yaw_arm        : Factor w/ 395 levels "","-0.01548",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ skewness_roll_arm       : Factor w/ 331 levels "","-0.00051",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ skewness_pitch_arm      : Factor w/ 328 levels "","-0.00184",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ skewness_yaw_arm        : Factor w/ 395 levels "","-0.00311",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ max_roll_arm            : num  NA NA NA NA NA NA NA NA NA NA ...
 $ max_picth_arm           : num  NA NA NA NA NA NA NA NA NA NA ...
 $ max_yaw_arm             : int  NA NA NA NA NA NA NA NA NA NA ...
 $ min_roll_arm            : num  NA NA NA NA NA NA NA NA NA NA ...
 $ min_pitch_arm           : num  NA NA NA NA NA NA NA NA NA NA ...
 $ min_yaw_arm             : int  NA NA NA NA NA NA NA NA NA NA ...
 $ amplitude_roll_arm      : num  NA NA NA NA NA NA NA NA NA NA ...
 $ amplitude_pitch_arm     : num  NA NA NA NA NA NA NA NA NA NA ...
 $ amplitude_yaw_arm       : int  NA NA NA NA NA NA NA NA NA NA ...
 $ roll_dumbbell           : num  13.1 13.1 12.9 13.4 13.4 ...
 $ pitch_dumbbell          : num  -70.5 -70.6 -70.3 -70.4 -70.4 ...
 $ yaw_dumbbell            : num  -84.9 -84.7 -85.1 -84.9 -84.9 ...
 $ kurtosis_roll_dumbbell  : Factor w/ 398 levels "","-0.0035","-0.0073",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ kurtosis_picth_dumbbell : Factor w/ 401 levels "","-0.0163","-0.0233",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ kurtosis_yaw_dumbbell   : Factor w/ 2 levels "","#DIV/0!": 1 1 1 1 1 1 1 1 1 1 ...
 $ skewness_roll_dumbbell  : Factor w/ 401 levels "","-0.0082","-0.0096",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ skewness_pitch_dumbbell : Factor w/ 402 levels "","-0.0053","-0.0084",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ skewness_yaw_dumbbell   : Factor w/ 2 levels "","#DIV/0!": 1 1 1 1 1 1 1 1 1 1 ...
 $ max_roll_dumbbell       : num  NA NA NA NA NA NA NA NA NA NA ...
 $ max_picth_dumbbell      : num  NA NA NA NA NA NA NA NA NA NA ...
 $ max_yaw_dumbbell        : Factor w/ 73 levels "","-0.1","-0.2",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ min_roll_dumbbell       : num  NA NA NA NA NA NA NA NA NA NA ...
 $ min_pitch_dumbbell      : num  NA NA NA NA NA NA NA NA NA NA ...
 $ min_yaw_dumbbell        : Factor w/ 73 levels "","-0.1","-0.2",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ amplitude_roll_dumbbell : num  NA NA NA NA NA NA NA NA NA NA ...
  [list output truncated]
> str(ptest)
'data.frame':	20 obs. of  160 variables:
 $ X                       : int  1 2 3 4 5 6 7 8 9 10 ...
 $ user_name               : Factor w/ 6 levels "adelmo","carlitos",..: 6 5 5 1 4 5 5 5 2 3 ...
 $ raw_timestamp_part_1    : int  1323095002 1322673067 1322673075 1322832789 1322489635 1322673149 1322673128 1322673076 1323084240 1322837822 ...
 $ raw_timestamp_part_2    : int  868349 778725 342967 560311 814776 510661 766645 54671 916313 384285 ...
 $ cvtd_timestamp          : Factor w/ 11 levels "02/12/2011 13:33",..: 5 10 10 1 6 11 11 10 3 2 ...
 $ new_window              : Factor w/ 1 level "no": 1 1 1 1 1 1 1 1 1 1 ...
 $ num_window              : int  74 431 439 194 235 504 485 440 323 664 ...
 $ roll_belt               : num  123 1.02 0.87 125 1.35 -5.92 1.2 0.43 0.93 114 ...
 $ pitch_belt              : num  27 4.87 1.82 -41.6 3.33 1.59 4.44 4.15 6.72 22.4 ...
 $ yaw_belt                : num  -4.75 -88.9 -88.5 162 -88.6 -87.7 -87.3 -88.5 -93.7 -13.1 ...
 $ total_accel_belt        : int  20 4 5 17 3 4 4 4 4 18 ...
 $ kurtosis_roll_belt      : logi  NA NA NA NA NA NA ...
 $ kurtosis_picth_belt     : logi  NA NA NA NA NA NA ...
 $ kurtosis_yaw_belt       : logi  NA NA NA NA NA NA ...
 $ skewness_roll_belt      : logi  NA NA NA NA NA NA ...
 $ skewness_roll_belt.1    : logi  NA NA NA NA NA NA ...
 $ skewness_yaw_belt       : logi  NA NA NA NA NA NA ...
 $ max_roll_belt           : logi  NA NA NA NA NA NA ...
 $ max_picth_belt          : logi  NA NA NA NA NA NA ...
 $ max_yaw_belt            : logi  NA NA NA NA NA NA ...
 $ min_roll_belt           : logi  NA NA NA NA NA NA ...
 $ min_pitch_belt          : logi  NA NA NA NA NA NA ...
 $ min_yaw_belt            : logi  NA NA NA NA NA NA ...
 $ amplitude_roll_belt     : logi  NA NA NA NA NA NA ...
 $ amplitude_pitch_belt    : logi  NA NA NA NA NA NA ...
 $ amplitude_yaw_belt      : logi  NA NA NA NA NA NA ...
 $ var_total_accel_belt    : logi  NA NA NA NA NA NA ...
 $ avg_roll_belt           : logi  NA NA NA NA NA NA ...
 $ stddev_roll_belt        : logi  NA NA NA NA NA NA ...
 $ var_roll_belt           : logi  NA NA NA NA NA NA ...
 $ avg_pitch_belt          : logi  NA NA NA NA NA NA ...
 $ stddev_pitch_belt       : logi  NA NA NA NA NA NA ...
 $ var_pitch_belt          : logi  NA NA NA NA NA NA ...
 $ avg_yaw_belt            : logi  NA NA NA NA NA NA ...
 $ stddev_yaw_belt         : logi  NA NA NA NA NA NA ...
 $ var_yaw_belt            : logi  NA NA NA NA NA NA ...
 $ gyros_belt_x            : num  -0.5 -0.06 0.05 0.11 0.03 0.1 -0.06 -0.18 0.1 0.14 ...
 $ gyros_belt_y            : num  -0.02 -0.02 0.02 0.11 0.02 0.05 0 -0.02 0 0.11 ...
 $ gyros_belt_z            : num  -0.46 -0.07 0.03 -0.16 0 -0.13 0 -0.03 -0.02 -0.16 ...
 $ accel_belt_x            : int  -38 -13 1 46 -8 -11 -14 -10 -15 -25 ...
 $ accel_belt_y            : int  69 11 -1 45 4 -16 2 -2 1 63 ...
 $ accel_belt_z            : int  -179 39 49 -156 27 38 35 42 32 -158 ...
 $ magnet_belt_x           : int  -13 43 29 169 33 31 50 39 -6 10 ...
 $ magnet_belt_y           : int  581 636 631 608 566 638 622 635 600 601 ...
 $ magnet_belt_z           : int  -382 -309 -312 -304 -418 -291 -315 -305 -302 -330 ...
 $ roll_arm                : num  40.7 0 0 -109 76.1 0 0 0 -137 -82.4 ...
 $ pitch_arm               : num  -27.8 0 0 55 2.76 0 0 0 11.2 -63.8 ...
 $ yaw_arm                 : num  178 0 0 -142 102 0 0 0 -167 -75.3 ...
 $ total_accel_arm         : int  10 38 44 25 29 14 15 22 34 32 ...
 $ var_accel_arm           : logi  NA NA NA NA NA NA ...
 $ avg_roll_arm            : logi  NA NA NA NA NA NA ...
 $ stddev_roll_arm         : logi  NA NA NA NA NA NA ...
 $ var_roll_arm            : logi  NA NA NA NA NA NA ...
 $ avg_pitch_arm           : logi  NA NA NA NA NA NA ...
 $ stddev_pitch_arm        : logi  NA NA NA NA NA NA ...
 $ var_pitch_arm           : logi  NA NA NA NA NA NA ...
 $ avg_yaw_arm             : logi  NA NA NA NA NA NA ...
 $ stddev_yaw_arm          : logi  NA NA NA NA NA NA ...
 $ var_yaw_arm             : logi  NA NA NA NA NA NA ...
 $ gyros_arm_x             : num  -1.65 -1.17 2.1 0.22 -1.96 0.02 2.36 -3.71 0.03 0.26 ...
 $ gyros_arm_y             : num  0.48 0.85 -1.36 -0.51 0.79 0.05 -1.01 1.85 -0.02 -0.5 ...
 $ gyros_arm_z             : num  -0.18 -0.43 1.13 0.92 -0.54 -0.07 0.89 -0.69 -0.02 0.79 ...
 $ accel_arm_x             : int  16 -290 -341 -238 -197 -26 99 -98 -287 -301 ...
 $ accel_arm_y             : int  38 215 245 -57 200 130 79 175 111 -42 ...
 $ accel_arm_z             : int  93 -90 -87 6 -30 -19 -67 -78 -122 -80 ...
 $ magnet_arm_x            : int  -326 -325 -264 -173 -170 396 702 535 -367 -420 ...
 $ magnet_arm_y            : int  385 447 474 257 275 176 15 215 335 294 ...
 $ magnet_arm_z            : int  481 434 413 633 617 516 217 385 520 493 ...
 $ kurtosis_roll_arm       : logi  NA NA NA NA NA NA ...
 $ kurtosis_picth_arm      : logi  NA NA NA NA NA NA ...
 $ kurtosis_yaw_arm        : logi  NA NA NA NA NA NA ...
 $ skewness_roll_arm       : logi  NA NA NA NA NA NA ...
 $ skewness_pitch_arm      : logi  NA NA NA NA NA NA ...
 $ skewness_yaw_arm        : logi  NA NA NA NA NA NA ...
 $ max_roll_arm            : logi  NA NA NA NA NA NA ...
 $ max_picth_arm           : logi  NA NA NA NA NA NA ...
 $ max_yaw_arm             : logi  NA NA NA NA NA NA ...
 $ min_roll_arm            : logi  NA NA NA NA NA NA ...
 $ min_pitch_arm           : logi  NA NA NA NA NA NA ...
 $ min_yaw_arm             : logi  NA NA NA NA NA NA ...
 $ amplitude_roll_arm      : logi  NA NA NA NA NA NA ...
 $ amplitude_pitch_arm     : logi  NA NA NA NA NA NA ...
 $ amplitude_yaw_arm       : logi  NA NA NA NA NA NA ...
 $ roll_dumbbell           : num  -17.7 54.5 57.1 43.1 -101.4 ...
 $ pitch_dumbbell          : num  25 -53.7 -51.4 -30 -53.4 ...
 $ yaw_dumbbell            : num  126.2 -75.5 -75.2 -103.3 -14.2 ...
 $ kurtosis_roll_dumbbell  : logi  NA NA NA NA NA NA ...
 $ kurtosis_picth_dumbbell : logi  NA NA NA NA NA NA ...
 $ kurtosis_yaw_dumbbell   : logi  NA NA NA NA NA NA ...
 $ skewness_roll_dumbbell  : logi  NA NA NA NA NA NA ...
 $ skewness_pitch_dumbbell : logi  NA NA NA NA NA NA ...
 $ skewness_yaw_dumbbell   : logi  NA NA NA NA NA NA ...
 $ max_roll_dumbbell       : logi  NA NA NA NA NA NA ...
 $ max_picth_dumbbell      : logi  NA NA NA NA NA NA ...
 $ max_yaw_dumbbell        : logi  NA NA NA NA NA NA ...
 $ min_roll_dumbbell       : logi  NA NA NA NA NA NA ...
 $ min_pitch_dumbbell      : logi  NA NA NA NA NA NA ...
 $ min_yaw_dumbbell        : logi  NA NA NA NA NA NA ...
 $ amplitude_roll_dumbbell : logi  NA NA NA NA NA NA ...
  [list output truncated]
> intrain <- createDataPartition(pmltrain$classe,p=.9,list=FALSE)
> traindata = ptrain[intrain,]
> testdata = ptrain[-intrain,]
> set.seed(32598)
> zzz <- nearZeroVar(traindata)
> trainz <- traindata[-zzz]
> testz <- testdata[-zzz]
> ptestz <- ptest[-zzz]
> dim(trainz)
[1] 17662   103
> ftridx <- which(lapply(trainz,class) %in% c('numeric'))
> trainz1 <- preProcess(trainz[,ftridx], method=c('knnImpute'))
> ftridx
 [1]   7   8   9  11  13  15  17  18  19  20  21  22  23  24  25  26  27  28  29  36  37  38
[23]  40  41  42  43  50  52  53  55  57  58  59  60  61  62  63  64  65  67  68  69  70  71
[45]  72  73  74  75  76  77  78  79  85  86  87  88  89  90  91  93  94  95  96 101 102
> trainz1
Created from 366 samples and 65 variables

Pre-processing:
  - centered (65)
  - ignored (0)
  - 5 nearest neighbor imputation (65)
  - scaled (65)

> pred1 <- predict(trainz1, trainz[,ftridx])
> predtrain <- cbind(trainz$classe,pred1)
> names(predtrain)[1] <- 'classe'
> predtrain[is.na(predtrain)] <- 0
> pred2 <- predict(trainz1, testz[,ftridx])
> predtest <- cbind(testz$classe, pred2)
> names(predtest)[1] <- 'classe'
> predtest[is.na(predtest)] <- 0
> predptest <- predict(trainz1,ptestz[,ftridx] )
> dim(predtrain)
[1] 17662    66
> #mod1 <- train(classe ~ ., method="glm",data=predtrain)
> #mod2 <- train(classe ~ ., method="rf",data=predtrain,trControl=trainControl(method="cv"),number=3)
> #mod1 <- glm(classe ~ .,predtrain)
> #mod1 <- glm.fit(classe ~ .,predtrain)
> model <- randomForest(classe~.,data=predtrain)
> predictiontraina <- predict(model, predtrain)
> print(table(predictiontraina, predtrain$classe))
                
predictiontraina    A    B    C    D    E
               A 5022    0    0    0    0
               B    0 3418    0    0    0
               C    0    0 3080    0    0
               D    0    0    0 2895    0
               E    0    0    0    0 3247
> training <- as.data.frame(table(predictiontraina, predtrain$classe))
> predictiontesta <- predict(model, predtest)
> print(table(predictiontesta, predtest$classe))
               
predictiontesta   A   B   C   D   E
              A 558   2   0   0   0
              B   0 373   2   0   0
              C   0   3 336   3   0
              D   0   1   2 318   1
              E   0   0   2   0 359
> str(predptest)
'data.frame':	20 obs. of  65 variables:
 $ roll_belt               : num  0.933 -1.011 -1.013 0.964 -1.006 ...
 $ pitch_belt              : num  1.1934 0.204 0.0677 -1.8736 0.1352 ...
 $ yaw_belt                : num  0.0662 -0.8176 -0.8134 1.8174 -0.8145 ...
 $ max_roll_belt           : num  0.0186 -0.8618 -0.8612 1.7838 -0.8701 ...
 $ min_roll_belt           : num  0.0467 -0.8325 -0.8319 1.8163 -0.8405 ...
 $ amplitude_roll_belt     : num  -0.0992 -0.1359 -0.1359 -0.0517 -0.1374 ...
 $ var_total_accel_belt    : num  -0.337 -0.312 -0.356 -0.374 -0.363 ...
 $ avg_roll_belt           : num  0.862 -1.062 -1.068 0.899 -1.054 ...
 $ stddev_roll_belt        : num  -0.449 -0.449 -0.441 -0.376 -0.482 ...
 $ var_roll_belt           : num  -0.327 -0.329 -0.328 -0.321 -0.33 ...
 $ avg_pitch_belt          : num  1.136 0.216 0.21 -1.851 0.181 ...
 $ stddev_pitch_belt       : num  -0.6081 0.144 -0.0807 -0.4338 -0.2219 ...
 $ var_pitch_belt          : num  -0.397 -0.113 -0.255 -0.326 -0.313 ...
 $ avg_yaw_belt            : num  0.0362 -0.8502 -0.8495 1.8098 -0.8582 ...
 $ stddev_yaw_belt         : num  -0.0957 -0.1183 -0.1202 -0.0685 -0.1218 ...
 $ var_yaw_belt            : num  -0.0682 -0.0683 -0.0683 -0.0679 -0.0683 ...
 $ gyros_belt_x            : num  -2.381 -0.266 0.263 0.552 0.167 ...
 $ gyros_belt_y            : num  -0.767 -0.767 -0.254 0.9 -0.254 ...
 $ gyros_belt_z            : num  -1.365 0.247 0.66 -0.125 0.536 ...
 $ roll_arm                : num  0.313 -0.246 -0.246 -1.744 0.799 ...
 $ pitch_arm               : num  -0.758 0.151 0.151 1.948 0.241 ...
 $ yaw_arm                 : num  2.5023 0.0132 0.0132 -1.9724 1.4396 ...
 $ var_accel_arm           : num  0.3349 -0.4845 0.0223 -0.4426 -0.5808 ...
 $ gyros_arm_x             : num  -0.8522 -0.6114 1.0295 0.0861 -1.0078 ...
 $ gyros_arm_y             : num  0.868 1.302 -1.293 -0.295 1.232 ...
 $ gyros_arm_z             : num  -0.815 -1.266 1.55 1.171 -1.464 ...
 $ max_picth_arm           : num  1.21 -0.489 -0.489 -1.224 0.802 ...
 $ min_roll_arm            : num  -0.395 0.715 0.715 0.74 -0.101 ...
 $ min_pitch_arm           : num  1.296 0.569 0.569 -1.283 1.018 ...
 $ amplitude_pitch_arm     : num  0.0872 -1.0296 -1.0296 -0.1136 -0.088 ...
 $ roll_dumbbell           : num  -0.596 0.436 0.473 0.274 -1.793 ...
 $ pitch_dumbbell          : num  0.959 -1.16 -1.097 -0.523 -1.153 ...
 $ yaw_dumbbell            : num  1.511 -0.937 -0.933 -1.275 -0.193 ...
 $ max_roll_dumbbell       : num  0.721 -1.049 -1.007 -0.794 -0.29 ...
 $ max_picth_dumbbell      : num  1.17 -1.033 -0.944 -1.289 0.294 ...
 $ min_roll_dumbbell       : num  1.487 -0.504 -0.603 0.131 -0.223 ...
 $ min_pitch_dumbbell      : num  1.864 -0.698 -0.669 -0.968 0.374 ...
 $ amplitude_roll_dumbbell : num  -0.289 -0.617 -0.519 -0.789 -0.117 ...
 $ amplitude_pitch_dumbbell: num  -0.43677 -0.67878 -0.58465 -0.7376 -0.00323 ...
 $ var_accel_dumbbell      : num  -0.234 -0.208 -0.19 -0.282 -0.276 ...
 $ avg_roll_dumbbell       : num  -0.39 0.597 0.649 0.406 -1.237 ...
 $ stddev_roll_dumbbell    : num  -0.345 -0.546 -0.498 -0.629 -0.119 ...
 $ var_roll_dumbbell       : num  -0.385 -0.418 -0.408 -0.437 -0.272 ...
 $ avg_pitch_dumbbell      : num  1.309 -1.075 -1.064 -0.552 -0.472 ...
 $ stddev_pitch_dumbbell   : num  -0.3554 -0.5635 -0.584 -0.7922 0.0825 ...
 $ var_pitch_dumbbell      : num  -0.4142 -0.4492 -0.4735 -0.5088 -0.0613 ...
 $ avg_yaw_dumbbell        : num  1.617 -0.93 -0.898 -1.238 0.326 ...
 $ stddev_yaw_dumbbell     : num  -0.461 -0.652 -0.5837 -0.7144 -0.0279 ...
 $ var_yaw_dumbbell        : num  -0.41 -0.444 -0.424 -0.454 -0.209 ...
 $ gyros_dumbbell_x        : num  0.3026 0.1133 0.1449 -0.0381 0.0818 ...
 $ gyros_dumbbell_y        : num  0.0216 0.00554 0.15008 -0.10688 -0.82956 ...
 $ gyros_dumbbell_z        : num  -0.2003 -0.2419 -0.0882 0.0738 -0.138 ...
 $ magnet_dumbbell_z       : num  -0.7286 -0.5859 -0.0365 0.0491 1.8971 ...
 $ roll_forearm            : num  0.992 0.696 0.9 -0.314 -1.944 ...
 $ pitch_forearm           : num  1.371 -1.007 -1.54 -0.381 -0.458 ...
 $ yaw_forearm             : num  1.328 0.843 0.717 -0.184 -0.649 ...
 $ max_picth_forearm       : num  0.694 0.692 0.465 -0.841 -0.212 ...
 $ min_pitch_forearm       : num  0.792 0.664 0.76 0.481 -0.544 ...
 $ amplitude_pitch_forearm : num  -0.148 -0.052 -0.272 -0.911 0.274 ...
 $ var_accel_forearm       : num  -0.62 -0.19 -0.756 -0.722 0.391 ...
 $ gyros_forearm_x         : num  0.897 1.4823 0.0346 1.8827 -1.3976 ...
 $ gyros_forearm_y         : num  -1.072 -0.896 -0.272 0.192 0.948 ...
 $ gyros_forearm_z         : num  -0.4048 -0.1818 0.0684 0.8951 0.3512 ...
 $ magnet_forearm_y        : num  0.0784 0.8086 0.6261 0.7929 -2.2889 ...
 $ magnet_forearm_z        : num  0.605 1.3 1.056 0.345 -0.821 ...
> predanswers <- predict(model, predptest)
> predanswers
 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 
 B  A  B  A  A  E  D  B  A  A  B  C  B  A  E  E  A  B  B  B 
Levels: A B C D E
> predanswers <- predict(model, predptest)
> predanswers
 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 
 B  A  B  A  A  E  D  B  A  A  B  C  B  A  E  E  A  B  B  B 
Levels: A B C D E
> pml_write_files = function(x){
+ n = length(x)
+ for(i in 1:n){
+ filename = paste("problem_id_",i,".txt")
+ write.table(x[i],file=filename,quote=FALSE,row.names=FALSE,col.names=FALSE)
+ }
+ }
> pml_write_files(as.character(predanswers))
> 
> 